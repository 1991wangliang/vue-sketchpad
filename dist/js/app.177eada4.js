(function(t){function e(e){for(var o,a,s=e[0],c=e[1],h=e[2],d=0,l=[];d<s.length;d++)a=s[d],Object.prototype.hasOwnProperty.call(r,a)&&r[a]&&l.push(r[a][0]),r[a]=0;for(o in c)Object.prototype.hasOwnProperty.call(c,o)&&(t[o]=c[o]);u&&u(e);while(l.length)l.shift()();return n.push.apply(n,h||[]),i()}function i(){for(var t,e=0;e<n.length;e++){for(var i=n[e],o=!0,s=1;s<i.length;s++){var c=i[s];0!==r[c]&&(o=!1)}o&&(n.splice(e--,1),t=a(a.s=i[0]))}return t}var o={},r={app:0},n=[];function a(e){if(o[e])return o[e].exports;var i=o[e]={i:e,l:!1,exports:{}};return t[e].call(i.exports,i,i.exports,a),i.l=!0,i.exports}a.m=t,a.c=o,a.d=function(t,e,i){a.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},a.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},a.t=function(t,e){if(1&e&&(t=a(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(a.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)a.d(i,o,function(e){return t[e]}.bind(null,o));return i},a.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return a.d(e,"a",e),e},a.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},a.p="/";var s=window["webpackJsonp"]=window["webpackJsonp"]||[],c=s.push.bind(s);s.push=e,s=s.slice();for(var h=0;h<s.length;h++)e(s[h]);var u=c;n.push([0,"chunk-vendors"]),i()})({0:function(t,e,i){t.exports=i("56d7")},1:function(t,e){},"1c3d":function(t,e,i){},"1f68":function(t,e,i){},2:function(t,e){},3:function(t,e){},"56d7":function(t,e,i){"use strict";i.r(e);i("e260"),i("e6cf"),i("cca6"),i("a79d");var o=i("2b0e"),r=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{attrs:{id:"app"}},[i("pad")],1)},n=[],a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{ref:"wraper",staticClass:"wraper"},[i("div",{staticClass:"canvas-wraper"},[i("canvas",{ref:"canvas",attrs:{id:"canvas"}})]),i("div",{staticClass:"controlPanel"},t._l(t.toolsArr,(function(e,o){return i("div",{key:o,class:[t.initIdx==o?"contro-item active":"contro-item"],on:{click:function(i){return t.handleTools(e,o)}}},[i("i",{class:"iconfont"+e.icon})])})),0),i("div",{staticClass:"download"},[i("button",{attrs:{type:"button",disabled:t.done},on:{click:t.downLoadImage}},[t._v("转换为base64并预览")]),i("img",{directives:[{name:"show",rawName:"v-show",value:""!=t.imageBase64,expression:"imageBase64!=''"}],attrs:{src:t.imageBase64,alt:""}})])])},s=[],c=(i("b0c0"),i("7a94")),h={data:function(){return{currentTool:"",done:!1,fabricObj:null,initIdx:0,toolsArr:[{name:"pencil",icon:" icon-pencil"},{name:"line",icon:" icon-line"},{name:"arrow",icon:" icon-arrow"},{name:"dashedline",icon:" icon-xuxian"},{name:"text",icon:" icon-ziti"},{name:"rectangle",icon:" icon-juxing"},{name:"circle",icon:" icon-yuanxing"},{name:"ellipse",icon:" icon-tuoyuanxing"},{name:"equilateral",icon:" icon-sanjiaoxing"},{name:"remove",icon:" icon-remove"},{name:"undo",icon:" icon-huitui"},{name:"redo",icon:" icon-xiangqian"},{name:"reset",icon:" icon-reset"}],mouseFrom:{},mouseTo:{},moveCount:1,doDrawing:!1,fabricHistoryJson:[],mods:0,drawingObject:null,drawColor:"#E34F51",drawWidth:2,imageBase64:"",zoom:window.zoom?window.zoom:1}},mounted:function(){this.initCanvas()},computed:{canvasWidth:function(){return window.innerWidth}},methods:{initCanvas:function(){this.fabricObj=new c["fabric"].Canvas("canvas",{isDrawingMode:!0,selectable:!1,selection:!1,devicePixelRatio:!0}),this.fabricObj.freeDrawingBrush.color="#E34F51",this.fabricObj.freeDrawingBrush.width=2,this.fabricObj.setWidth(this.canvasWidth),this.fabricObj.setHeight(500),this.fabricObj.add(new c["fabric"].Rect({top:100,left:100,width:50,height:50,fill:"#f55"}),new c["fabric"].Circle({top:140,left:230,radius:75,fill:"green"}),new c["fabric"].Triangle({top:300,left:210,width:100,height:100,fill:"blue"})),this.fabricObjAddEvent()},fabricObjAddEvent:function(){var t=this;this.fabricObj.on({"mouse:down":function(e){t.mouseFrom.x=e.pointer.x,t.mouseFrom.y=e.pointer.y,t.doDrawing=!0,"text"==t.currentTool&&t.drawText()},"mouse:up":function(e){t.mouseTo.x=e.pointer.x,t.mouseTo.y=e.pointer.y,t.drawingObject=null,t.moveCount=1,t.doDrawing=!1,t.updateModifications(!0)},"mouse:move":function(e){t.moveCount%2&&!t.doDrawing||(t.moveCount++,t.mouseTo.x=e.pointer.x,t.mouseTo.y=e.pointer.y,t.drawing())},"object:moving":function(t){t.target.opacity=.5},"object:added":function(){},"object:modified":function(e){e.target.opacity=1,t.updateModifications(!0)},"selection:created":function(e){if(e.target._objects)for(var i=e.target._objects.length,o=0;o<i;o++)t.fabricObj.remove(e.target._objects[o]);else t.fabricObj.remove(e.target);t.fabricObj.discardActiveObject(),t.updateModifications(!0)}})},updateModifications:function(t){1==t&&this.fabricHistoryJson.push(JSON.stringify(this.fabricObj))},undo:function(){var t=this.fabricHistoryJson;this.mods<t.length&&(this.fabricObj.clear().renderAll(),this.fabricObj.loadFromJSON(t[t.length-1-this.mods-1]),this.fabricObj.renderAll(),this.mods+=1)},redo:function(){var t=this.fabricHistoryJson;this.mods>0&&(this.fabricObj.clear().renderAll(),this.fabricObj.loadFromJSON(t[t.length-1-this.mods+1]),this.fabricObj.renderAll(),this.mods-=1)},transformMouse:function(t,e){return{x:t/this.zoom,y:e/this.zoom}},resetObj:function(){this.fabricObj.selectable=!1,this.fabricObj.selection=!1,this.fabricObj.skipTargetFind=!0,this.textboxObj&&(this.textboxObj.exitEditing(),this.textboxObj=null)},handleTools:function(t,e){switch(this.initIdx=e,this.currentTool=t.name,this.fabricObj.isDrawingMode=!1,this.resetObj(),t.name){case"pencil":this.fabricObj.isDrawingMode=!0;break;case"remove":this.fabricObj.selection=!0,this.fabricObj.skipTargetFind=!1,this.fabricObj.selectable=!0;break;case"reset":this.fabricObj.clear();break;case"redo":this.redo();break;case"undo":this.undo();break;default:break}},drawText:function(){this.textboxObj=new c["fabric"].Textbox(" ",{left:this.mouseFrom.x,top:this.mouseFrom.y,width:220,fontSize:18,fill:this.drawColor,hasControls:!0}),this.fabricObj.add(this.textboxObj),this.textboxObj.enterEditing(),this.textboxObj.hiddenTextarea.focus(),this.updateModifications(!0)},drawing:function(){var t=this;this.drawingObject&&this.fabricObj.remove(this.drawingObject);var e=null;switch(this.currentTool){case"pencil":this.fabricObj.isDrawingMode=!0;break;case"line":e=new c["fabric"].Line([this.mouseFrom.x,this.mouseFrom.y,this.mouseTo.x,this.mouseTo.y],{stroke:this.drawColor,strokeWidth:this.drawWidth});break;case"arrow":e=new c["fabric"].Path(this.drawArrow(this.mouseFrom.x,this.mouseFrom.y,this.mouseTo.x,this.mouseTo.y,15.5,15.5),{stroke:this.drawColor,fill:"rgba(255,255,255,0)",strokeWidth:this.drawWidth});break;case"dashedline":e=this.drawDoshedLine();break;case"rectangle":e=this.drawRectangle();break;case"circle":e=this.drawCircle();break;case"ellipse":e=this.drawEllipse();break;case"equilateral":e=this.drawTriangle();break;case"remove":break;default:break}e&&this.$nextTick((function(){t.fabricObj.add(e),t.drawingObject=e}))},drawDoshedLine:function(){return new c["fabric"].Line([this.mouseFrom.x,this.mouseFrom.y,this.mouseTo.x,this.mouseTo.y],{strokeDashArray:[10,3],stroke:this.drawColor,strokeWidth:this.drawWidth})},drawCircle:function(){var t=Math.sqrt((this.mouseTo.x-this.mouseFrom.x)*(this.mouseTo.x-this.mouseFrom.x)+(this.mouseTo.y-this.mouseFrom.y)*(this.mouseTo.y-this.mouseFrom.y))/2;return new c["fabric"].Circle({left:this.mouseFrom.x,top:this.mouseFrom.y,stroke:this.drawColor,fill:"rgba(255, 255, 255, 0)",radius:t,strokeWidth:this.drawWidth})},drawTriangle:function(){var t=this.mouseTo.y-this.mouseFrom.y;return new c["fabric"].Triangle({top:this.mouseFrom.y,left:this.mouseFrom.x,width:Math.sqrt(Math.pow(t,2)+Math.pow(t/2,2)),height:t,stroke:this.drawColor,strokeWidth:this.drawWidth,fill:"rgba(255,255,255,0)"})},drawEllipse:function(){var t=this.mouseFrom.x,e=this.mouseFrom.y;return new c["fabric"].Ellipse({left:t,top:e,stroke:this.drawColor,fill:"rgba(255, 255, 255, 0)",originX:"center",originY:"center",rx:Math.abs(t-this.mouseTo.x),ry:Math.abs(e-this.mouseTo.y),strokeWidth:this.drawWidth})},drawRectangle:function(){return new c["fabric"].Rect({left:this.mouseFrom.x,top:this.mouseFrom.y,width:this.mouseTo.x-this.mouseFrom.x,height:this.mouseTo.y-this.mouseFrom.y,fill:"rgba(255, 255, 255, 0)",stroke:this.drawColor,strokeWidth:this.drawWidth})},drawArrow:function(t,e,i,o,r,n){r="undefined"!=typeof r?r:30,n="undefined"!=typeof r?n:10;var a=180*Math.atan2(e-o,t-i)/Math.PI,s=(a+r)*Math.PI/180,c=(a-r)*Math.PI/180,h=n*Math.cos(s),u=n*Math.sin(s),d=n*Math.cos(c),l=n*Math.sin(c),f=t-h,b=e-u,m=" M "+t+" "+e;return m+=" L "+i+" "+o,f=i+h,b=o+u,m+=" M "+f+" "+b,m+=" L "+i+" "+o,f=i+d,b=o+l,m+=" L "+f+" "+b,m},downLoadImage:function(){this.done=!0;var t=this.fabricObj.toDataURL({formart:"png",multiplier:2});this.imageBase64=t,this.done=!1}}},u=h,d=(i("d99c"),i("2877")),l=Object(d["a"])(u,a,s,!1,null,"a371fea8",null),f=l.exports,b={name:"App",components:{pad:f}},m=b,w=Object(d["a"])(m,r,n,!1,null,null,null),p=w.exports;i("1f68"),i("a342");o["a"].config.productionTip=!1,new o["a"]({render:function(t){return t(p)}}).$mount("#app")},a342:function(t,e,i){},d99c:function(t,e,i){"use strict";i("1c3d")}});
//# sourceMappingURL=app.177eada4.js.map